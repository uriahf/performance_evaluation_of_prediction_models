{
  "hash": "474e5299585c8ea3f80da63e5e0963b0",
  "result": {
    "markdown": "---\ntitle: \"Performance Evaluation of Prediction Models\"\nauthor: \"Uriah Finkel\"\nformat:\n  revealjs:\n    theme:  [solarized, custom.scss]\n    incremental: true\n---\n\n\n## Agenda\n\n-   Introduction to performance metrics and curves for prediction models.\n\n-   For medical prediction models the most common outcome is a binary outcome, therefore this will be the focus of the lecture.\n\n## Code for Performance Metrics and Curves\n\nAll interactive plots in this presentation were created with [**rtichoke**](https://uriahf.github.io/rtichoke/) (I am the author üëã).\n\nYou are also invited to explore [**rtichoke blog**](https://rtichoke-blog.netlify.app/) for reproducible examples and some theory.\n\n## rtichoke blog {background-iframe=\"https://rtichoke-blog.netlify.app\"}\n\n## Motivation\n\n### Why using performance metrics? ü§î\n\n-   Choosing between different candidate models.\n-   Choosing between candidate features\n\n### Relevant Criteria besides Performance\n\n-   How difficult is it to implement the model?\n\n-   How difficult is it to explain the model?\n\n## Categories of Performance Metrics and Curves\n\n-   **Discrimination**: Model's ability to separate between events and non-events.\n\n-   **Calibration**: Agreement between predicted probabilities and the prevalence of the outcomes.\n\n-   **Utility**: The usefulness of the model in terms of decision-making.\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"50%\"}\n### [Green]{style=\"color: green;\"} {style=\"text-align: center; font-size: 200px;\"}\n\n::: {style=\"height:123px; width:100%; clear:both;\"}\n:::\n\n### **üôÇ** {style=\"text-align: center; font-size: 120px;\"}\n:::\n\n::: {.column width=\"50%\"}\n### [Red]{style=\"color: red;\"} {style=\"text-align: center; font-size: 200px;\"}\n\n::: {style=\"height:123px; width:100%; clear:both;\"}\n:::\n\n### **üôÅ** {style=\"text-align: center; font-size: 120px;\"}\n:::\n:::\n\n------------------------------------------------------------------------\n\n::: columns\n::: {.column width=\"50%\"}\n### [Green]{style=\"color: green;\"} {style=\"text-align: center; font-size: 200px;\"}\n\n::: {style=\"height: 0px; width:100%; clear:both;\"}\n:::\n\n![](Maccabi_Haifa_FC_logo.svg){fig-align=\"center\" width=\"200\"}\n:::\n\n::: {.column width=\"50%\"}\n### [Red]{style=\"color: red;\"} {style=\"text-align: center; font-size: 200px;\"}\n\n::: {style=\"height: 49px; width:100%; clear:both;\"}\n:::\n\n![](Hapoel_Haifa_Football_Club_Logo.png){fig-align=\"center\" width=\"200\"}\n:::\n:::\n\n# Discrimination\n\n## Discrimination\n\nThis is the most known and used category of performance metrics and curves.\n\n## [True Positives]{style=\"color: green;\"} {.smaller}\n\n### Infected and Predicted as Infected - [Good]{style=\"color: green;\"}\n\n[**üíä**]{style=\"font-size: 50px;\"} <br> [ü§¢]{style=\"font-size: 50px;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-2950cf8b52ab652354c4\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2950cf8b52ab652354c4\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"type\":[\"Real Positive\",\"Real Negative\"],\"predicted_positive\":[\"TP\",\"FP\"],\"predicted_negative\":[\"FN\",\"TN\"]},\"columns\":[{\"accessor\":\"type\",\"name\":\"\",\"type\":\"character\",\"align\":\"left\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":{\"fontWeight\":100}},{\"accessor\":\"predicted_positive\",\"name\":\"Predicted Positive\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600,\"background\":\"lightgreen\"},{\"fontWeight\":600,\"background\":null}]},{\"accessor\":\"predicted_negative\",\"name\":\"Predicted Negative\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600},{\"fontWeight\":600}]}],\"sortable\":false,\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"inline\":true,\"theme\":{\"backgroundColor\":\"#fdf6e3\"},\"dataKey\":\"0e87a4d202a6e42067acce914af1bd56\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## [False Positives]{style=\"color: red;\"} {.smaller}\n\n### Not-Infected and Predicted as Infected - [BAD]{style=\"color: red;\"}\n\n[**üíä**]{style=\"font-size: 50px;\"} <br> [ü§®]{style=\"font-size: 50px;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-b0d6c21b2b5fdbabcd79\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b0d6c21b2b5fdbabcd79\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"type\":[\"Real Positive\",\"Real Negative\"],\"predicted_positive\":[\"TP\",\"FP\"],\"predicted_negative\":[\"FN\",\"TN\"]},\"columns\":[{\"accessor\":\"type\",\"name\":\"\",\"type\":\"character\",\"align\":\"left\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":{\"fontWeight\":100}},{\"accessor\":\"predicted_positive\",\"name\":\"Predicted Positive\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600,\"background\":null},{\"fontWeight\":600,\"background\":\"pink\"}]},{\"accessor\":\"predicted_negative\",\"name\":\"Predicted Negative\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600},{\"fontWeight\":600}]}],\"sortable\":false,\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"inline\":true,\"theme\":{\"backgroundColor\":\"#fdf6e3\"},\"dataKey\":\"481602af31df52dab4020d6cbdbba680\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## [False Negatives]{style=\"color: red;\"} {.smaller}\n\n### Infected and Predicted as Not-Infected - [BAD]{style=\"color: red;\"}\n\n<br> [ü§¢]{style=\"font-size: 50px;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-f0373fa819abe5139bad\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f0373fa819abe5139bad\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"type\":[\"Real Positive\",\"Real Negative\"],\"predicted_positive\":[\"TP\",\"FP\"],\"predicted_negative\":[\"FN\",\"TN\"]},\"columns\":[{\"accessor\":\"type\",\"name\":\"\",\"type\":\"character\",\"align\":\"left\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":{\"fontWeight\":100}},{\"accessor\":\"predicted_positive\",\"name\":\"Predicted Positive\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600},{\"fontWeight\":600}]},{\"accessor\":\"predicted_negative\",\"name\":\"Predicted Negative\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600,\"background\":\"pink\"},{\"fontWeight\":600,\"background\":null}]}],\"sortable\":false,\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"inline\":true,\"theme\":{\"backgroundColor\":\"#fdf6e3\"},\"dataKey\":\"9899aad0c3275e615a5f64b37cbf4d85\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## [True Negatives]{style=\"color: green;\"} {.smaller}\n\n### Not-Infected and Predicted as Not-Infected - [BAD]{style=\"color: green;\"}\n\n<br> [ü§®]{style=\"font-size: 50px;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-a510d7b3e5ba827b5a13\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a510d7b3e5ba827b5a13\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"type\":[\"Real Positive\",\"Real Negative\"],\"predicted_positive\":[\"TP\",\"FP\"],\"predicted_negative\":[\"FN\",\"TN\"]},\"columns\":[{\"accessor\":\"type\",\"name\":\"\",\"type\":\"character\",\"align\":\"left\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":{\"fontWeight\":100}},{\"accessor\":\"predicted_positive\",\"name\":\"Predicted Positive\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600},{\"fontWeight\":600}]},{\"accessor\":\"predicted_negative\",\"name\":\"Predicted Negative\",\"type\":\"character\",\"align\":\"center\",\"headerStyle\":{\"fontWeight\":100},\"minWidth\":200,\"style\":[{\"fontWeight\":600,\"background\":null},{\"fontWeight\":600,\"background\":\"lightgreen\"}]}],\"sortable\":false,\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"inline\":true,\"theme\":{\"backgroundColor\":\"#fdf6e3\"},\"dataKey\":\"fc6b82a5989b085e90f9be912e39ffb3\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Probability Threshold:\n\nMost Performance Metrics are estimated by using a Probability Threshold in order to classify each probability to Predicted Negative (Do not Treat) or Predicted Positive (Treat üíä).\\\n\nThis type of dichotomization is being used when the intervention carries a **potential risk** and there is a trade-off of risks between the intervention and the outcome.\n\n## Probability Threshold:\n\n<table>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>pÃÇ</strong></p></td>\n<td style=\"text-align: center;\"><p>0.3</p></td>\n<td style=\"text-align: center;\"><p>0.6</p></td>\n<td style=\"text-align: center;\"><p>0.4</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n<td style=\"text-align: center;\"><p>0.4</p></td>\n<td style=\"text-align: center;\"><p>0.7</p></td>\n<td style=\"text-align: center;\"><p>0.3</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n<td style=\"text-align: center;\"><p>0.2</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>Y</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n</tr>\n</tbody>\n</table>\n\n## Probability Threshold:\n\n## Low Probability Threshold:\n\nLow Probability Threshold means that I'm worried about the **outcome**:\n\n-   I'm worried about **Prostate Cancer** ü¶Ä\n-   I'm worried about **Heart Disease** üíî\n-   I'm worried about **Infection** ü§¢\n\n## Probability Threshold of 0.25\n\n<table>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: center;\"><p><strong>pÃÇ</strong></p></th>\n<th style=\"text-align: center;\"><p>0.3</p></th>\n<th style=\"text-align: center;\"><p>0.6</p></th>\n<th style=\"text-align: center;\"><p>0.4</p></th>\n<th style=\"text-align: center;\"><p>0.1</p></th>\n<th style=\"text-align: center;\"><p>0.4</p></th>\n<th style=\"text-align: center;\"><p>0.7</p></th>\n<th style=\"text-align: center;\"><p>0.3</p></th>\n<th style=\"text-align: center;\"><p>0.1</p></th>\n<th style=\"text-align: center;\"><p>0.2</p></th>\n<th style=\"text-align: center;\"><p>0.1</p></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>≈∂</strong></p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>Y</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n</tr>\n</tbody>\n</table>\n\n## High Probability Threshold:\n\nHigh Probability Threshold means that I'm worried about the **Intervention**:\n\n-   I'm worried about **Biopsy** üíâ\n\n-   I'm worried about **Statins** üíä\n\n-   I'm worried about **Antibiotics** üíä\n\n## Probability Threshold of 0.55\n\n<table>\n<thead>\n<tr class=\"header\">\n<th style=\"text-align: center;\"><p><strong>pÃÇ</strong></p></th>\n<th style=\"text-align: center;\"><p>0.3</p></th>\n<th style=\"text-align: center;\"><p>0.6</p></th>\n<th style=\"text-align: center;\"><p>0.4</p></th>\n<th style=\"text-align: center;\"><p>0.1</p></th>\n<th style=\"text-align: center;\"><p>0.4</p></th>\n<th style=\"text-align: center;\"><p>0.7</p></th>\n<th style=\"text-align: center;\"><p>0.3</p></th>\n<th style=\"text-align: center;\"><p>0.1</p></th>\n<th style=\"text-align: center;\"><p>0.2</p></th>\n<th style=\"text-align: center;\"><p>0.1</p></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>≈∂</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>Y</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><strong>TN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n</tr>\n</tbody>\n</table>\n\n## PPCR (Predicted Positives Conditional Rate):\n\n$\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TP + FP}}{\\text{TP + FP + TN + FN}}}\\end{aligned} = \\begin{aligned} \\ {\\scriptsize \\frac{\\text{Predicted Positives}}{\\text{Total Population}}}\\end{aligned}$\n\nSometimes we will classify each observation according to the ranking of the risk in order to prioritize high-risk patients regardless their absolute risk.\n\nThe implied assumption is that the highest risk might gain the highest benefit from the treatment and that the treatment does not carry a significant potential risk.\n\nThis type of dichotomization is being used when the organization face **resource constraint**. In healthcare we call it also **Risk Percentile**.\n\n## PPCR of 0.1\n\n<table>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>pÃÇ</strong></p></td>\n<td style=\"text-align: center;\"><p>0.3</p></td>\n<td style=\"text-align: center;\"><p>0.6</p></td>\n<td style=\"text-align: center;\"><p>0.4</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n<td style=\"text-align: center;\"><p>0.4</p></td>\n<td style=\"text-align: center;\"><p>0.7</p></td>\n<td style=\"text-align: center;\"><p>0.3</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n<td style=\"text-align: center;\"><p>0.2</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>R</strong></p></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>≈∂</strong></p></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>Y</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"></td>\n</tr>\n</tbody>\n</table>\n\n## PPCR of 0.1\n\n<table>\n<tbody>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>pÃÇ</strong></p></td>\n<td style=\"text-align: center;\"><p>0.3</p></td>\n<td style=\"text-align: center;\"><p>0.6</p></td>\n<td style=\"text-align: center;\"><p>0.4</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n<td style=\"text-align: center;\"><p>0.4</p></td>\n<td style=\"text-align: center;\"><p>0.7</p></td>\n<td style=\"text-align: center;\"><p>0.3</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n<td style=\"text-align: center;\"><p>0.2</p></td>\n<td style=\"text-align: center;\"><p>0.1</p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>R</strong></p></td>\n<td style=\"text-align: center;\"><p>5.5</p></td>\n<td style=\"text-align: center;\"><p>2</p></td>\n<td style=\"text-align: center;\"><p>3.5</p></td>\n<td style=\"text-align: center;\"><p>9</p></td>\n<td style=\"text-align: center;\"><p>3.5</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>5.5</p></td>\n<td style=\"text-align: center;\"><p>9</p></td>\n<td style=\"text-align: center;\"><p>7</p></td>\n<td style=\"text-align: center;\"><p>9</p></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"><p><strong>≈∂</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"><p><strong>Y</strong></p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n<td style=\"text-align: center;\"><p>1</p></td>\n<td style=\"text-align: center;\"><p>0</p></td>\n</tr>\n<tr class=\"odd\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><span class=\"emoji\" data-emoji=\"pill\">üíä</span> <br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"nauseated_face\">ü§¢</span></p></td>\n<td style=\"text-align: center;\"><p><br />\n<span class=\"emoji\" data-emoji=\"raised_eyebrow\">ü§®</span></p></td>\n</tr>\n<tr class=\"even\">\n<td style=\"text-align: center;\"></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>TP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FP</strong></p></td>\n<td style=\"text-align: center;\"><p><strong>FN</strong></p></td>\n</tr>\n</tbody>\n</table>\n\n## ROC Curve\n\n-   The most famous form of Performance Metrics Visualization\n\n-   Displays Sensitivity (also known as True Positive Rate or Percision) on the y axis\n\n-   Displays 1 - Specificity (also known as False Positive Rate) on the x axis.\n\n## Why I don't like ROC Curve üò§\n\n### Why 1 - Specificity? Why not just Specificity? üôÉ\n\nHonestly, I didn't find anywhere why *1 - Specificity* is more insightful than just *Specificity.*\n\ntodo: add roc reversed and regular\n\n## Why I don't like ROC Curve üò§\n\n### Sensitivity and Specificity do not respect the flow of time üï∞Ô∏è\n\n![](real_positives_future.jpg)\n\n## Why I don't like ROC Curve üò§\n\n### Sensitivity and Specificity do not respect the flow of time üï∞Ô∏è {.smaller}\n\n<br>\n\nSensitivity: $\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TP}}{\\text{TP + FN}} = \\text{Prob( Predicted Positive | Real Positive )}}\\end{aligned}$\n\n<br>\n\nSpecificity: $\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TN}}{\\text{TN + FP}} = \\text{Prob( Predicted Negative | Real Negative )} } \\end{aligned}$\n\n<br>\n\nWe do not know the condition of the Conditional Probability: Not the number of future Real Positives nor the number of future Real Negatives.\n\n## Why I don't like ROC Curve üò§\n\n### Sensitivity and Specificity do not respect the flow of time üï∞Ô∏è {.smaller}\n\n<br>\n\nPPV: $\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TP}}{\\text{TP + FP}} = \\text{Prob( Real Positive | Predicted Positive )}}\\end{aligned}$\n\n<br>\n\nNPV: $\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TN}}{\\text{TN + FN}} = \\text{Prob( Real Negative | Predicted Negative )} } \\end{aligned}$\n\nWe know the condition of the Conditional Probability: The number of Predicted Positives and the number of Predicted Negatives.\n\n## Why I don't like ROC Curve üò§\n\n### You don't care about auroc, you care about the c-statistics\n\n-   Generally speaking, the more area under a curve with two \"Good\" performance metrics, is better. Other than that, there is no context and performance metrics with no context might lead to ambiguity and bad decisions.\n\n-   Another Curve: Precision-Recall is made of Sensitivity (Precision) and PPV (Recall). How much PRAUC is enough?\n\n-   Why not calculating GAINSAUC? Or any combination of two good performance metrics? We can get with Sensitivity, Specificity, NPV, PPV 6 AUC metrics. Do they provide any meaningful insight besides a vague *the more the better*?\n\n-   One might suggest that the visual aspect is useful, but as human beings we are really bad at interpreting round things.\n\n-   really bad Ink-to-ratio\n\n## What is the AUROC of the following Models?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](performance_evaluation_of_prediction_models_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n## What is the AUROC of the following Models?\n\n![](khaby.gif)\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-d4584abf90735d84991e\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d4584abf90735d84991e\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"population\":[\"First Model\",\"Second Model\"],\"auc\":[0.9586,0.8648]},\"columns\":[{\"accessor\":\"population\",\"name\":\"Model\",\"type\":\"factor\",\"show\":true,\"cell\":[{\"name\":\"Fragment\",\"attribs\":[],\"children\":[{\"name\":\"span\",\"attribs\":{\"style\":{\"display\":\"inline-block\",\"marginRight\":\"8px\",\"width\":\"9px\",\"height\":\"9px\",\"backgroundColor\":\"#1b9e77\",\"borderRadius\":\"50%\"}},\"children\":[]},\"First Model\"]},{\"name\":\"Fragment\",\"attribs\":[],\"children\":[{\"name\":\"span\",\"attribs\":{\"style\":{\"display\":\"inline-block\",\"marginRight\":\"8px\",\"width\":\"9px\",\"height\":\"9px\",\"backgroundColor\":\"#d95f02\",\"borderRadius\":\"50%\"}},\"children\":[]},\"Second Model\"]}],\"minWidth\":300},{\"accessor\":\"auc\",\"name\":\"AUROC\",\"type\":\"numeric\",\"cell\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\"}},\"children\":[\"0.96\",{\"name\":\"div\",\"attribs\":{\"style\":{\"flexGrow\":1,\"marginLeft\":\"8px\",\"background\":\"#e1e1e1\"}},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"background\":\"green\",\"width\":\"95.86%\",\"height\":\"16px\"}},\"children\":[]}]}]},{\"name\":\"div\",\"attribs\":{\"style\":{\"display\":\"flex\",\"alignItems\":\"center\"}},\"children\":[\"0.86\",{\"name\":\"div\",\"attribs\":{\"style\":{\"flexGrow\":1,\"marginLeft\":\"8px\",\"background\":\"#e1e1e1\"}},\"children\":[{\"name\":\"div\",\"attribs\":{\"style\":{\"background\":\"green\",\"width\":\"86.48%\",\"height\":\"16px\"}},\"children\":[]}]}]}],\"minWidth\":300,\"align\":\"left\"}],\"sortable\":false,\"defaultPageSize\":10,\"paginationType\":\"numbers\",\"showPageInfo\":true,\"minRows\":1,\"inline\":true,\"theme\":{\"backgroundColor\":\"#fdf6e3\"},\"dataKey\":\"3f38f391c186fb012470a2d5b009ebb9\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Why I don't like ROC Curve üò§\n\n### You don't care about auroc, you care about the c-statistics\n\nYet, the auroc is valuable because of the equivalence to the c-statistics and it might provide good intuition about the performance of the model.\n\n## Discrimination - Common Performance Metrics:\n\n<br>\n\nSensitivity: $\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TP}}{\\text{TP + FN}} = \\text{Prob( Predicted Positive | Real Positive )}}\\end{aligned}$\n\n<br>\n\nSpecificity: $\\begin{aligned} \\ {\\scriptsize \\frac{\\text{TP}}{\\text{TP + FN}} = \\text{Prob( Predicted Positive | Real Positive )} } \\end{aligned}$\n\n## Discrimination - bla\n\n::: columns\n::: {.column width=\"50%\"}\nSensitivity vs Specificity\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n:::\n\n:::\n:::\n\n## Calibration\n\n## Utility\n\n## Bla\n\n\n```{ojs}\nd3 = require(\"d3@7\")\ntopojson = require(\"topojson\")\n```\n\n\n## bla bla\n\n\n```{ojs}\nimport { aq, op } from '@uwdata/arquero'\npenguins = aq.loadCSV(\"palmer-penguins.csv\")\npenguins.view()\npenguins\n  .groupby('species')\n  .filter(d => d.body_mass_g > 0)\n  .rollup({\n    count: op.count(),\n    avg_mass: op.average('body_mass_g')\n   })\n  .view()\n```\n\n\nIf you want to use inputs in an arquero query, you can use the `params` method of table. Below is a simple example of filtering a dataset by the values provided.\n\n\n```{ojs}\n//| panel: input\nviewof bill_length_min = Inputs.range(\n  [32, 50],\n  {value: 35, step: 1, label: \"Bill length (min):\"}\n)\nviewof islands = Inputs.checkbox(\n  [\"Torgersen\", \"Biscoe\", \"Dream\"],\n  { value: [\"Torgersen\", \"Biscoe\"],\n    label: \"Islands:\"\n  }\n)\n```\n\n```{ojs}\npenguins\n  .params({\n    blm: bill_length_min,\n    i: islands\n  })\n  .filter((d, $) => op.includes($.i, d.island) && d.bill_length_mm > $.blm)\n  .view()\n```\n",
    "supporting": [
      "performance_evaluation_of_prediction_models_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"performance_evaluation_of_prediction_models_files/libs/core-js-2.5.3/shim.min.js\"></script>\r\n<script src=\"performance_evaluation_of_prediction_models_files/libs/react-17.0.0/react.min.js\"></script>\r\n<script src=\"performance_evaluation_of_prediction_models_files/libs/react-17.0.0/react-dom.min.js\"></script>\r\n<script src=\"performance_evaluation_of_prediction_models_files/libs/reactwidget-1.0.0/react-tools.js\"></script>\r\n<script src=\"performance_evaluation_of_prediction_models_files/libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\r\n<script src=\"performance_evaluation_of_prediction_models_files/libs/reactable-binding-0.3.0/reactable.js\"></script>\r\n"
      ],
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}